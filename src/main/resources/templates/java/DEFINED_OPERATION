<#import "import/classMemberTemplates" as classMembers/>
//CHECKSTYLE:OFF
package ${currentPackage};

<@classMembers.addRootClassAnnotations/>
public class ${className} implements ${operationsPackage}.${operation?cap_first}
{
	private static final String OPERATION_NAME = <#if name?has_content>"${name}"<#else>null</#if>;
	private static final String DOCUMENT = <#if text?has_content>"${text?j_string}"<#else>null</#if>;
	<#if variables?has_content>
	private final java.util.Map<String, Object> variables;

	public ${className}(java.util.function.Consumer<${className}Variables> variables) {
		java.util.Map<String, Object> map = new java.util.HashMap<>();
		variables.accept(new ${className}Variables(map));
		this.variables = java.util.Collections.unmodifiableMap(map);
	}
	</#if>

	@Override
	public String getOperationName() {
		return OPERATION_NAME;
	}

	@Override
	public String getDocument() {
		return DOCUMENT;
	}

	@Override
	public java.util.Map<String, Object> getVariables() {
		<#if variables?has_content>
		return variables;
		<#else>
		return java.util.Collections.emptyMap();
		</#if>
	}

	@Override
	public Class<${currentPackage}.results.${typeName}> getResultClass() {
		return ${currentPackage}.results.${typeName}.class;
	}

	@Override
	public boolean equals(Object o) {
		if (this == o) return true;
		if (!(o instanceof ${className})) return false;
		${className} other = (${className}) o;
		java.util.Map<String, Object> otherVariables = other.getVariables();
		java.util.Map<String, Object> currentVariables = getVariables();
		if (otherVariables == currentVariables) {
			return true;
		}
		if (otherVariables == null || currentVariables == null) {
			return false;
		}
		return otherVariables.equals(currentVariables);
	}

	@Override
	public int hashCode() {
		return java.util.Objects.hashCode(getVariables());
	}


	<@classMembers.addToString fields=[{'name':'operationName'},{'name':'document'},{'name':'variables'}] indent='\t'/>
}
//CHECKSTYLE:ON
